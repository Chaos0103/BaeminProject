<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head::head(~{::title})">
    <title>배달의 민족 | 배민페이</title>
</head>
<body>
<header th:replace="fragments/loginHeader::loginHeader"></header>
<div th:replace="fragments/notifications::notifications(${notifications})"></div>

<article>
    <div class="container px-4 py-5">
        <div>
            <!-- top info -->
            <section>
                <div class="container text-center">
                    <div class="row bg-main text-white" style="">
                        <div class="col-sm-2 align-self-center fs-1 bg-main">
                            MY배민
                        </div>
                        <div class="col border-start">
                            <div class="row align-self-center text-start p-2">
                                <div class="col fs-5">
                                    회원등급
                                </div>
                            </div>
                            <div class="row align-self-center fs-1 ps-3">
                                <div class="col text-end" th:text="${pay.member.grade}">
                                    VIP
                                </div>
                            </div>
                        </div>
                        <div class="col border-start">
                            <div class="row align-self-center text-start p-2">
                                <div class="col fs-5">
                                    할인쿠폰
                                </div>
                            </div>
                            <div class="row align-self-center fs-1 ps-3">
                                <div class="col text-end">
                                    0장
                                </div>
                            </div>
                        </div>
                        <div class="col border-start">
                            <div class="row align-self-center text-start p-2">
                                <div class="col fs-5">
                                    리뷰작성
                                </div>
                            </div>
                            <div class="row align-self-center fs-1 ps-3">
                                <div class="col text-end">
                                    0개
                                </div>
                            </div>
                        </div>
                        <div class="col border-start">
                            <div class="row border-bottom h-50">
                                <div class="col-sm-4 align-self-center text-start fs-5">
                                    포인트
                                </div>
                                <div class="col align-self-center text-end">
                                    500,000 원
                                </div>
                            </div>
                            <div class="row h-50">
                                <div class="col-sm-4 align-self-center text-start fs-5">
                                    페이
                                </div>
                                <div class="col align-self-center text-end" th:text="|${#numbers.formatInteger(pay.money, 0, 'COMMA')} 원|">
                                    500,000 원
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <div class="container text-center">
                    <!-- sidebar start -->
                    <div class="row">
                        <div class="col-sm-2 border text-start bg-secondary bg-opacity-10" style="height: 500px;">
                            <nav class="nav flex-column mt-4">
                                <div class="border-bottom">
                                    <label class="nav-link text-dark">MY 배달</label>
                                    <a class="nav-link" aria-current="page" href="/orders">주문내역</a>
                                </div>
                                <div class="border-bottom">
                                    <label class="nav-link text-dark">MY 혜택</label>
                                    <a class="nav-link" aria-current="page" href="#">포인트</a>
                                    <a class="nav-link" aria-current="page" href="#">쿠폰함</a>
                                </div>
                                <div class="border-bottom">
                                    <label class="nav-link text-dark">MY 활동</label>
                                    <a class="nav-link" aria-current="page" href="#">리뷰관리</a>
                                    <a class="nav-link" aria-current="page" href="#">찜 리스트</a>
                                </div>
                                <div>
                                    <label class="nav-link text-dark">MY 정보</label>
                                    <a class="nav-link" aria-current="page" href="#">개인정보확인/수정</a>
                                    <a class="nav-link" aria-current="page" href="/pay">페이</a>
                                </div>
                            </nav>
                        </div>
                        <!-- sidebar end -->
                        <div class="col text-start">
                            <div class="m-4">
                                <div class="row mb-1">
                                    <div class="col">
                                        <h2>배민페이</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="m-4 bg-main border">
                                <div class="row m-3">
                                    <div class="col-sm-4 align-self-center">
                                        <h2 class="m-4 text-white">배민페이머니</h2>
                                    </div>
                                    <div class="col">
                                        <div class="m-4 fs-2 text-white" th:text="|${#numbers.formatInteger(pay.money, 0, 'COMMA')} 원|">
                                            0원
                                        </div>
                                    </div>
                                </div>
                                <div class="row text-center m-3">
                                    <div class="col d-grid gap-2 mx-auto">
                                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#payHistory">사용내역</button>
                                    </div>
                                    <div class="col d-grid gap-2 mx-auto">
                                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#charge">충전</button>
                                    </div>
                                    <div class="col d-grid gap-2 mx-auto">
                                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#refund">환불</button>
                                    </div>
                                </div>
                            </div>
                            <div class="m-4 border bg-secondary bg-opacity-10">
                                <div class="row text-center ms-1 me-1" style="height: 125px;">
                                    <div onclick="location.href='#'" class="col border-end">
                                        <div class="row h-100">
                                            <div class="col align-self-center fs-3">
                                                결제수단 관리
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col" data-bs-toggle="modal" data-bs-target="#changePayPassword">
                                        <div class="row h-100">
                                            <div class="col align-self-center fs-3">
                                                비밀번호 변경
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</article>
<!-- Modal -->
<div class="modal fade" id="payHistory" tabindex="-1" aria-labelledby="payHistoryLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="payHistoryLabel">배민페이머니 사용내역</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="card mb-3" th:each="payHistory:${payHistories}">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <span th:text="${payHistory.content}">배민페이</span><br><span th:text="${#temporals.format(payHistory.createdDate, 'yyyy-MM-dd hh:mm:ss')}">2022-08-15 22:41:57</span>
                            </div>
                            <div th:if="${payHistory.type.toString()} == 'REFUND'" class="col text-end align-self-center" th:text="|-${#numbers.formatInteger(payHistory.price, 0, 'COMMA')}원 환불|">
                                -20,000원 환불
                            </div>
                            <div th:if="${payHistory.type.toString()} == 'CHARGE'" class="col text-end align-self-center text-danger" th:text="|${#numbers.formatInteger(payHistory.price, 0, 'COMMA')}원 충전|">
                                20,000원 충전
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-muted" style="font-size: 90%;">
                    <p>배민페이머니 결제 시 혜택</p>
                    <ul>
                        <li>결제 금액의 0.5% 적립</li>
                        <li>소득공제 혜택 적용 (현금영수증 발행)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="charge" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="chargeLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="chargeLabel">배민페이머니 충전</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" th:action="@{/pay/charge}">
                    <div class="mb-3">
                        <label for="chargePayMoney" class="form-label"><strong>충전 금액</strong></label>
                        <span class="float-end text-muted" th:text="|충전 가능 금액 ${#numbers.formatInteger(2000000 - pay.money, 0, 'COMMA')}원|"></span>
                        <input type="text" class="form-control" th:field="${money.money}" id="chargePayMoney" placeholder="충전 금액을 입력하세요. (1만원부터 충전 가능)">
                    </div>
                    <div class="mt-3 text-muted" style="font-size: 90%;">
                        <p>배민페이머니 이용 안내</p>
                        <ul>
                            <li>배민페이머니로 주문하면 0.5%가 배민포인트로 적립됩니다.</li>
                            <li>배민페이머니 한도는 아이디 통합으로 관리되며, 200만원까지 보유하실 수 있습니다.</li>
                        </ul>
                    </div>
                    <button type="submit" class="btn baemin-btn w-100">충전하기</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="refund" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="refundLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="refundLabel">배민페이머니 충전</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <h5>환불 예정 금액</h5>
                    <h5 th:text="|${#numbers.formatInteger(pay.money, 0, 'COMMA')}원|">0원</h5>
                </div>
                <div class="mt-3 text-muted" style="font-size: 90%;">
                    <p>배민페이머니 환불 안내</p>
                    <ul>
                        <li>배민페이머니는 전액 환불만 가능합니다.(부분 환불 불가)</li>
                        <li>환불 요청 시 선택한 배민페이 계좌로 환불됩니다.</li>
                        <li>환불 결과는 배민페이머니 사용 내역에서 확인하실 수 있으며, 최대 3영업일이 소요될 수 있습니다.</li>
                    </ul>
                </div>
                <form th:action="@{/pay/refund}" method="post">
                    <button type="submit" class="btn baemin-btn w-100">환불하기</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- change pay password -->
<div class="modal fade" id="changePayPassword" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="changePayPasswordLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="changePayPasswordLabel">비밀번호 변경하기</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" th:action="@{/pay/changePassword}">
                    <div class="mb-3">
                        <label for="nowPassword" class="form-label">현재 비밀번호</label>
                        <input type="password" class="form-control" id="nowPassword" placeholder="" maxlength="6">
                    </div>
                    <div class="mb-3">
                        <label for="newPassword" class="form-label">새로운 비밀번호</label>
                        <input type="password" class="form-control" id="newPassword" placeholder="" maxlength="6">
                    </div>
                    <div class="mb-3">
                        <label for="checkNewPassword" class="form-label">비밀번호 확인</label>
                        <input type="password" class="form-control" id="checkNewPassword" placeholder="" maxlength="6">
                    </div>
                    <button type="submit" class="btn baemin-btn w-100">변경하기</button>
                </form>
            </div>
        </div>
    </div>
</div>

<footer th:replace="fragments/footer::footer"></footer>
</body>

</html>